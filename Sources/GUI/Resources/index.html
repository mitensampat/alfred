<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Alfred</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1a1d21; color: #d1d2d3; line-height: 1.5; }
        .auth-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
        .auth-logo { font-size: 24px; font-weight: 700; letter-spacing: 2px; color: #fff; margin-bottom: 40px; }
        .auth-card { width: 100%; max-width: 400px; background: #1a1d21; border: 1px solid #2f3338; border-radius: 8px; padding: 24px; }
        .auth-card input { width: 100%; padding: 12px; background: #000; border: 1px solid #2f3338; border-radius: 4px; color: #fff; font-size: 15px; }
        .auth-card button { width: 100%; padding: 12px; background: #007a5a; border: none; border-radius: 4px; color: #fff; font-size: 15px; font-weight: 600; margin-top: 16px; cursor: pointer; }
        .auth-card button:active { background: #006644; }
        .auth-error { color: #e01e5a; font-size: 13px; margin-top: 12px; }
        .app-container { display: none; max-width: 680px; margin: 0 auto; }
        .app-container.active { display: block; }
        .header { background: #522d5b; padding: 20px; text-align: center; }
        .header h1 { font-size: 18px; font-weight: 700; letter-spacing: 1.5px; color: #fff; margin-bottom: 4px; }
        .header p { font-size: 11px; color: rgba(255,255,255,0.8); }
        .menu-section { padding: 8px; }
        .menu-item { background: #1a1d21; border: 1px solid #2f3338; border-radius: 8px; padding: 16px; margin-bottom: 8px; cursor: pointer; }
        .menu-item:active { background: #2f3338; }
        .menu-item-header { display: flex; align-items: center; gap: 12px; }
        .menu-item-icon { font-size: 20px; }
        .menu-item-content { flex: 1; }
        .menu-item-title { font-size: 15px; font-weight: 600; color: #fff; margin-bottom: 2px; }
        .menu-item-subtitle { font-size: 13px; color: #9ca3af; }
        .detail-view { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #1a1d21; z-index: 100; overflow-y: auto; }
        .detail-view.active { display: block; }
        .detail-header { background: #522d5b; padding: 16px; display: flex; align-items: center; gap: 12px; }
        .back-button { background: none; border: none; color: #fff; font-size: 24px; cursor: pointer; padding: 4px; }
        .detail-title { font-size: 18px; font-weight: 600; color: #fff; }
        .detail-content { padding: 16px; }
        .card { background: #1a1d21; border: 1px solid #2f3338; border-radius: 8px; padding: 16px; margin-bottom: 12px; }
        .card-title { font-size: 15px; font-weight: 600; color: #fff; margin-bottom: 8px; }
        .card-text { font-size: 14px; color: #9ca3af; line-height: 1.5; }
        .badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-left: 8px; }
        .badge-high { background: rgba(224, 30, 90, 0.2); color: #e01e5a; }
        .badge-medium { background: rgba(255, 212, 0, 0.2); color: #ffd400; }
        .badge-low { background: rgba(90, 200, 250, 0.2); color: #5ac8fa; }
        .action-button { width: 100%; padding: 12px; background: #007a5a; border: none; border-radius: 4px; color: #fff; font-size: 15px; font-weight: 600; cursor: pointer; margin-top: 12px; }
        .action-button:active { background: #006644; }
        .action-button.secondary { background: #2f3338; }
        .action-button.secondary:active { background: #404449; }
        .loading { text-align: center; padding: 40px; color: #9ca3af; }
        .hidden { display: none !important; }
        .time { font-size: 13px; color: #9ca3af; }
        .preview-link { text-align: center; padding: 8px; margin-bottom: 8px; }
        .preview-link a { background: #522d5b; color: #fff; text-decoration: none; font-size: 13px; font-weight: 600; padding: 12px 16px; border-radius: 6px; display: inline-block; }
        .preview-link a:hover { background: #6d3a7a; }
    </style>
</head>
<body>
    <div id="authScreen" class="auth-screen">
        <div class="auth-logo">ALFRED</div>
        <div class="auth-card">
            <input type="password" id="passcodeInput" placeholder="Enter passcode" />
            <button onclick="authenticate()">Unlock</button>
            <div id="authError" class="auth-error hidden"></div>
        </div>
    </div>
    <div id="appContainer" class="app-container">
        <div class="header"><h1>ALFRED</h1><p id="greeting">Your executive assistant</p></div>
        <div class="menu-section">
            <div class="preview-link">
                <a href="/index-v2.html">‚ú® Try Conversational Interface (Preview)</a>
            </div>
            <div class="menu-item" onclick="showBriefing()"><div class="menu-item-header"><div class="menu-item-icon">üìÖ</div><div class="menu-item-content"><div class="menu-item-title">briefing</div><div class="menu-item-subtitle">daily summary & insights</div></div></div></div>
            <div class="menu-item" onclick="showCalendar()"><div class="menu-item-header"><div class="menu-item-icon">üóìÔ∏è</div><div class="menu-item-content"><div class="menu-item-title">calendar</div><div class="menu-item-subtitle">meetings & schedule</div></div></div></div>
            <div class="menu-item" onclick="showMessages()"><div class="menu-item-header"><div class="menu-item-icon">üí¨</div><div class="menu-item-content"><div class="menu-item-title">messages</div><div class="menu-item-subtitle">recent conversations</div></div></div></div>
            <div class="menu-item" onclick="showCommitments()"><div class="menu-item-header"><div class="menu-item-icon">üìã</div><div class="menu-item-content"><div class="menu-item-title">commitments</div><div class="menu-item-subtitle">track promises & obligations</div></div></div></div>
            <div class="menu-item" onclick="showDrafts()"><div class="menu-item-header"><div class="menu-item-icon">üìù</div><div class="menu-item-content"><div class="menu-item-title">agent drafts</div><div class="menu-item-subtitle">review AI-generated messages</div></div></div></div>
            <div class="menu-item" onclick="showTodoScan()"><div class="menu-item-header"><div class="menu-item-icon">‚úÖ</div><div class="menu-item-content"><div class="menu-item-title">scan for todos</div><div class="menu-item-subtitle">check whatsapp notes</div></div></div></div>
            <div class="menu-item" onclick="showAttentionCheck()"><div class="menu-item-header"><div class="menu-item-icon">üëÅÔ∏è</div><div class="menu-item-content"><div class="menu-item-title">attention check</div><div class="menu-item-subtitle">what can you push off?</div></div></div></div>
        </div>
    </div>
    <div id="briefingOptionsView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Briefing</div></div><div class="detail-content" id="briefingOptionsContent"></div></div>
    <div id="briefingView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Today's Briefing</div></div><div class="detail-content" id="briefingContent"><div class="loading">Loading...</div></div></div>
    <div id="calendarOptionsView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Calendar</div></div><div class="detail-content" id="calendarOptionsContent"></div></div>
    <div id="calendarView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Calendar</div></div><div class="detail-content" id="calendarContent"><div class="loading">Loading...</div></div></div>
    <div id="messagesOptionsView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Messages</div></div><div class="detail-content" id="messagesOptionsContent"></div></div>
    <div id="messagesView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Messages</div></div><div class="detail-content" id="messagesContent"><div class="loading">Loading...</div></div></div>
    <div id="commitmentsView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Commitments</div></div><div class="detail-content" id="commitmentsContent"><div class="loading">Loading...</div></div></div>
    <div id="draftsView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Agent Drafts</div></div><div class="detail-content" id="draftsContent"><div class="loading">Loading...</div></div></div>
    <div id="todoScanView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Scan for Todos</div></div><div class="detail-content" id="todoScanContent"><div class="loading">Loading...</div></div></div>
    <div id="attentionCheckView" class="detail-view"><div class="detail-header"><button class="back-button" onclick="goBack()">‚Üê</button><div class="detail-title">Attention Check</div></div><div class="detail-content" id="attentionCheckContent"><div class="loading">Loading...</div></div></div>
    <script>
        let apiKey='';let selectedDate='today';let selectedPlatform='all';function authenticate(){const p=document.getElementById('passcodeInput').value;if(!p){showAuthError('Please enter a passcode');return;}apiKey=p;fetch('/api/health',{headers:{'X-API-Key':apiKey}}).then(r=>{if(r.ok){localStorage.setItem('alfred-api-key',apiKey);showApp();}else{showAuthError('Invalid passcode');}}).catch(()=>showAuthError('Connection failed'));}function showAuthError(m){const e=document.getElementById('authError');e.textContent=m;e.classList.remove('hidden');}function showApp(){document.getElementById('authScreen').style.display='none';document.getElementById('appContainer').classList.add('active');updateGreeting();}function updateGreeting(){const h=new Date().getHours();let g='Good evening';if(h<12)g='Good morning';else if(h<17)g='Good afternoon';document.getElementById('greeting').textContent=g;}function goBack(){document.querySelectorAll('.detail-view').forEach(v=>v.classList.remove('active'));}function showBriefing(){document.getElementById('briefingOptionsView').classList.add('active');loadBriefingOptions();}function showCalendar(){document.getElementById('calendarOptionsView').classList.add('active');loadCalendarOptions();}function showMessages(){document.getElementById('messagesOptionsView').classList.add('active');loadMessagesOptions();}function showCommitments(){document.getElementById('commitmentsView').classList.add('active');loadCommitments();}function showDrafts(){document.getElementById('draftsView').classList.add('active');loadDrafts();}function showTodoScan(){document.getElementById('todoScanView').classList.add('active');loadTodoScan();}function showAttentionCheck(){document.getElementById('attentionCheckView').classList.add('active');loadAttentionCheck();}function loadBriefingOptions(){const html='<div class="card" onclick="loadBriefingData()"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">‚òÄÔ∏è</div><div style="flex:1;"><div class="card-title" style="margin:0;">today</div><div class="card-text">briefing for today</div></div></div></div><div class="card" onclick="alert(\'Tomorrow briefing coming soon\')"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">üåÖ</div><div style="flex:1;"><div class="card-title" style="margin:0;">tomorrow</div><div class="card-text">briefing for tomorrow</div></div></div></div>';document.getElementById('briefingOptionsContent').innerHTML=html;}function loadCalendarOptions(){const html='<div class="card" onclick="loadCalendarData()"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">‚òÄÔ∏è</div><div style="flex:1;"><div class="card-title" style="margin:0;">today</div><div class="card-text">calendar for today</div></div></div></div><div class="card" onclick="alert(\'Tomorrow calendar coming soon\')"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">üåÖ</div><div style="flex:1;"><div class="card-title" style="margin:0;">tomorrow</div><div class="card-text">calendar for tomorrow</div></div></div></div><div style="margin-top:20px;font-size:11px;font-weight:600;color:#9ca3af;letter-spacing:1px;">CALENDAR FILTER</div><div class="card" onclick="loadCalendarData()"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">üìÖ</div><div style="flex:1;"><div class="card-title" style="margin:0;">all calendars</div><div class="card-text">show all events</div></div></div></div>';document.getElementById('calendarOptionsContent').innerHTML=html;}function loadMessagesOptions(){const html='<div style="font-size:11px;font-weight:600;color:#9ca3af;letter-spacing:1px;margin-bottom:12px;">SELECT PLATFORM</div><div class="card" onclick="loadMessagesData(\'all\')"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">üí¨</div><div style="flex:1;"><div class="card-title" style="margin:0;">all platforms</div><div class="card-text">analyze all messages</div></div></div></div><div class="card" onclick="loadMessagesData(\'imessage\')"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">‚úâÔ∏è</div><div style="flex:1;"><div class="card-title" style="margin:0;">imessage</div><div class="card-text">iMessage conversations only</div></div></div></div><div class="card" onclick="loadMessagesData(\'whatsapp\')"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">üì±</div><div style="flex:1;"><div class="card-title" style="margin:0;">whatsapp</div><div class="card-text">WhatsApp conversations only</div></div></div></div>';document.getElementById('messagesOptionsContent').innerHTML=html;}function loadBriefingData(){document.getElementById('briefingOptionsView').classList.remove('active');document.getElementById('briefingView').classList.add('active');loadBriefing();}function loadCalendarData(){document.getElementById('calendarOptionsView').classList.remove('active');document.getElementById('calendarView').classList.add('active');loadCalendar();}function loadMessagesData(platform){selectedPlatform=platform;document.getElementById('messagesOptionsView').classList.remove('active');document.getElementById('messagesView').classList.add('active');loadMessages();}function loadBriefing(){fetch('/api/briefing',{headers:{'X-API-Key':apiKey}}).then(r=>r.json()).then(data=>{let html='';html+='<div style="display:flex;gap:8px;margin-bottom:16px;">';html+=`<div class="card" style="flex:1;text-align:center;"><div style="font-size:24px;font-weight:700;color:#fff;">${data.stats.meetings}</div><div style="font-size:11px;color:#9ca3af;">MEETINGS</div></div>`;html+=`<div class="card" style="flex:1;text-align:center;"><div style="font-size:24px;font-weight:700;color:#fff;">${data.stats.messages}</div><div style="font-size:11px;color:#9ca3af;">MESSAGES</div></div>`;const fh=Math.floor(data.stats.focusTimeSeconds/3600);html+=`<div class="card" style="flex:1;text-align:center;"><div style="font-size:24px;font-weight:700;color:#fff;">${fh}h</div><div style="font-size:11px;color:#9ca3af;">FOCUS</div></div>`;html+='</div>';if(data.actionItems?.length>0){html+='<div style="font-size:11px;font-weight:600;color:#9ca3af;margin-bottom:12px;letter-spacing:1px;">TOP PRIORITIES</div>';data.actionItems.slice(0,3).forEach((item,i)=>{const badge=item.priority==='critical'?'high':item.priority;html+=`<div class="card"><div style="display:flex;gap:12px;align-items:start;"><div style="font-size:20px;font-weight:700;color:#522d5b;">${i+1}</div><div style="flex:1;"><div class="card-title" style="margin:0;">${item.title}</div><div class="card-text">${item.description}</div><div class="time" style="margin-top:8px;">${item.category} <span class="badge badge-${badge}">${item.priority}</span></div></div></div></div>`;});}if(data.messages?.criticalMessages?.length>0){html+='<div style="font-size:11px;font-weight:600;color:#9ca3af;margin:20px 0 12px 0;letter-spacing:1px;">CRITICAL MESSAGES</div>';data.messages.criticalMessages.slice(0,3).forEach(m=>{html+=`<div class="card"><div class="card-title">${m.contact} <span class="badge badge-high">CRITICAL</span></div><div class="card-text">${m.summary}</div></div>`;});}if(data.calendar?.recommendations?.length>0){html+='<div style="font-size:11px;font-weight:600;color:#9ca3af;margin:20px 0 12px 0;letter-spacing:1px;">RECOMMENDATIONS</div>';data.calendar.recommendations.forEach(r=>{html+=`<div class="card"><div class="card-text">üí° ${r}</div></div>`;});}document.getElementById('briefingContent').innerHTML=html;}).catch(e=>{console.error(e);document.getElementById('briefingContent').innerHTML='<div class="card-text" style="color:#e01e5a;">Error loading briefing</div>';});}function loadCalendar(){fetch('/api/calendar',{headers:{'X-API-Key':apiKey}}).then(r=>r.json()).then(data=>{let html='';const hrs=Math.floor(data.focusTime/3600);const mins=Math.floor((data.focusTime%3600)/60);html+=`<div class="card"><div class="card-title">üìä Overview</div><div class="card-text">${data.schedule.events.length} meetings ‚Ä¢ ${hrs}h ${mins}m focus time available</div></div>`;if(data.meetingBriefings?.length>0){html+='<div style="font-size:11px;font-weight:600;color:#9ca3af;margin:20px 0 12px 0;letter-spacing:1px;">MEETING BRIEFINGS</div>';data.meetingBriefings.forEach(mb=>{const st=new Date(mb.event.start).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});const et=new Date(mb.event.end).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});html+=`<div class="card"><div class="card-title">${mb.event.title}</div><div class="time" style="margin:8px 0;">${st} - ${et}</div><div class="card-text"><strong>Preparation:</strong> ${mb.preparation}</div>`;if(mb.suggestedTopics?.length>0){html+='<div class="card-text" style="margin-top:8px;"><strong>Topics:</strong><ul style="margin:4px 0 0 20px;">';mb.suggestedTopics.forEach(t=>html+=`<li>${t}</li>`);html+='</ul></div>';}html+='</div>';});}else if(data.schedule?.events?.length>0){data.schedule.events.forEach(e=>{const st=new Date(e.start).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});const et=new Date(e.end).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});html+=`<div class="card"><div class="card-title">${e.title}</div><div class="time">${st} - ${et}</div>${e.location?`<div class="card-text" style="margin-top:8px;">üìç ${e.location}</div>`:''}</div>`;});}else{html+='<div class="card"><div class="card-text">No events today</div></div>';}if(data.recommendations?.length>0){html+='<div style="font-size:11px;font-weight:600;color:#9ca3af;margin:20px 0 12px 0;letter-spacing:1px;">RECOMMENDATIONS</div>';data.recommendations.forEach(r=>{html+=`<div class="card"><div class="card-text">üí° ${r}</div></div>`;});}document.getElementById('calendarContent').innerHTML=html;}).catch(e=>{console.error(e);document.getElementById('calendarContent').innerHTML='<div class="card-text" style="color:#e01e5a;">Error loading calendar</div>';});}function loadMessages(){fetch(`/api/messages?platform=${selectedPlatform}&timeframe=24h`,{headers:{'X-API-Key':apiKey}}).then(r=>r.json()).then(data=>{let html='';if(data.messages?.length>0){data.messages.forEach(m=>{const badge=m.urgency==='critical'?'high':m.urgency;html+=`<div class="card"><div class="card-title">${m.contact} <span class="badge badge-${badge}">${m.urgency.toUpperCase()}</span></div><div class="card-text">${m.summary}</div>`;if(m.actionItems?.length>0){html+='<div class="card-text" style="margin-top:8px;"><strong>Action items:</strong><ul style="margin:4px 0 0 20px;">';m.actionItems.forEach(a=>html+=`<li>${a}</li>`);html+='</ul></div>';}html+=`<div class="time" style="margin-top:8px;">${m.platform} ‚Ä¢ ${m.unreadCount} unread</div></div>`;});}else{html='<div class="card"><div class="card-text">No messages</div></div>';}document.getElementById('messagesContent').innerHTML=html;}).catch(e=>{console.error(e);document.getElementById('messagesContent').innerHTML='<div class="card-text" style="color:#e01e5a;">Error loading messages</div>';});}function loadCommitments(){fetch('/api/commitments',{headers:{'X-API-Key':apiKey}}).then(r=>r.json()).then(data=>{let html='';if(data.commitments?.length>0){data.commitments.forEach(c=>{const over=c.isOverdue?' <span class="badge badge-high">OVERDUE</span>':'';html+=`<div class="card"><div class="card-title">${c.title}${over}</div><div class="card-text">${c.commitmentText}</div><div class="time" style="margin-top:8px;">${c.type} ‚Ä¢ ${c.status} ‚Ä¢ ${c.sourcePlatform}${c.dueDate?' ‚Ä¢ Due: '+new Date(c.dueDate).toLocaleDateString():''}</div></div>`;});html+='<button class="action-button" onclick="scanCommitments()">Scan for New Commitments</button>';}else{html='<div class="card"><div class="card-text">No commitments</div></div>';html+='<button class="action-button" onclick="scanCommitments()">Scan for Commitments</button>';}document.getElementById('commitmentsContent').innerHTML=html;});}function scanCommitments(){const btn=event.target;btn.textContent='Scanning...';btn.disabled=true;fetch('/api/commitments/scan',{method:'POST',headers:{'X-API-Key':apiKey,'Content-Type':'application/json'},body:JSON.stringify({lookbackDays:14})}).then(r=>r.json()).then(data=>{alert(`Found ${data.found} commitments\nSaved ${data.saved} new ones\n${data.duplicates} duplicates`);loadCommitments();}).catch(()=>{alert('Failed to scan commitments');btn.textContent='Scan for Commitments';btn.disabled=false;});}function loadDrafts(){fetch('/api/drafts',{headers:{'X-API-Key':apiKey}}).then(r=>r.json()).then(data=>{let html='';if(data.drafts?.length>0){data.drafts.forEach(d=>{html+=`<div class="card"><div class="card-title">${d.recipient}</div><div class="card-text">${d.content}</div><div class="time" style="margin-top:8px;">${d.platform} ‚Ä¢ ${d.tone}</div><button class="action-button secondary" onclick="copyDraft(this,'${d.content.replace(/'/g,"\\'")}')">Copy to Clipboard</button></div>`;});}else{html='<div class="card"><div class="card-text">No drafts available</div></div>';}document.getElementById('draftsContent').innerHTML=html;});}function loadTodoScan(){document.getElementById('todoScanContent').innerHTML='<div class="card"><div style="text-align:center;padding:20px;"><div style="font-size:48px;margin-bottom:20px;">üîç</div><div class="card-title">Scan WhatsApp Messages</div><div class="card-text" style="margin:12px 0;">I will check messages you sent to yourself and extract todos</div><button class="action-button" onclick="runTodoScan()">START SCAN</button></div></div>';}function runTodoScan(){const btn=event.target;btn.textContent='Scanning...';btn.disabled=true;fetch('/api/todos/scan',{method:'POST',headers:{'X-API-Key':apiKey}}).then(r=>r.json()).then(data=>{let html='<div class="card" style="background:rgba(0,122,90,0.1);border-color:#007a5a;"><div class="card-title">‚úÖ Scan Complete</div><div class="card-text">Found ${data.count} todos</div></div>';if(data.todos?.length>0){data.todos.forEach(t=>{html+=`<div class="card"><div class="card-title">${t.title}</div>${t.description?`<div class="card-text">${t.description}</div>`:''}<div class="time" style="margin-top:8px;">From: ${t.source.sender}${t.dueDate?' ‚Ä¢ Due: '+new Date(t.dueDate).toLocaleDateString():''}</div></div>`;});}document.getElementById('todoScanContent').innerHTML=html;}).catch(e=>{console.error(e);btn.textContent='START SCAN';btn.disabled=false;alert('Failed to scan todos');});}function loadAttentionCheck(){fetch('/api/attention-check',{headers:{'X-API-Key':apiKey}}).then(r=>r.json()).then(data=>{let html='<div class="card" style="background:rgba(224,30,90,0.1);border-color:#e01e5a;"><div style="display:flex;align-items:center;gap:12px;"><div style="font-size:24px;">‚ö°</div><div><div class="card-title">Attention Check</div><div class="card-text">Time to prioritize what matters</div></div></div></div>';if(data.mustDoToday?.length>0){html+='<div style="font-size:11px;font-weight:600;color:#9ca3af;margin:20px 0 12px 0;letter-spacing:1px;">MUST COMPLETE TODAY</div>';data.mustDoToday.forEach(item=>{html+=`<div class="card"><div style="display:flex;gap:8px;align-items:start;"><div style="width:8px;height:8px;border-radius:50%;background:#e01e5a;margin-top:6px;"></div><div style="flex:1;"><div class="card-title" style="margin:0;">${item.title}</div><div class="card-text">${item.description}</div><div class="time" style="margin-top:8px;">PRIORITY: ${item.priority.toUpperCase()}</div></div></div></div>`;});}if(data.canPushOff?.length>0){html+='<div style="font-size:11px;font-weight:600;color:#9ca3af;margin:20px 0 12px 0;letter-spacing:1px;">CAN PUSH TO LATER</div>';data.canPushOff.forEach(s=>{const newDate=new Date(s.suggestedNewDate).toLocaleDateString();html+=`<div class="card"><div style="display:flex;gap:8px;align-items:start;"><div style="width:8px;height:8px;border-radius:50%;background:#5ac8fa;margin-top:6px;"></div><div style="flex:1;"><div class="card-title" style="margin:0;">${s.item.title}</div><div class="card-text">${s.reason}</div><div class="time" style="margin-top:8px;">IMPACT: ${s.impact.toUpperCase()} ‚Ä¢ Suggested: ${newDate}</div></div></div></div>`;});}if(data.recommendations?.length>0){html+='<div style="font-size:11px;font-weight:600;color:#9ca3af;margin:20px 0 12px 0;letter-spacing:1px;">RECOMMENDATIONS</div>';data.recommendations.forEach(r=>{html+=`<div class="card"><div class="card-text">üí° ${r}</div></div>`;});}document.getElementById('attentionCheckContent').innerHTML=html;}).catch(e=>{console.error(e);document.getElementById('attentionCheckContent').innerHTML='<div class="card-text" style="color:#e01e5a;">Error loading attention check</div>';});}function copyDraft(btn,text){navigator.clipboard.writeText(text).then(()=>{const orig=btn.textContent;btn.textContent='Copied!';setTimeout(()=>btn.textContent=orig,2000);});}window.addEventListener('load',()=>{const key=localStorage.getItem('alfred-api-key');if(key){apiKey=key;showApp();}});
    </script>
</body>
</html>
